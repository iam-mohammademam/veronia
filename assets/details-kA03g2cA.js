import{u as j,a as E,c as B,j as e,n as U,p as P,i as p,q as z,r as u,t as G,b as N,F as L,v as M,w as R,x as k,y as D,_ as F,z as H,B as I,C as o,D as q,s as K,E as Y,G as Z,N as W}from"./index-e85yjnfv.js";import{G as J,b as O,c as Q,C as V,a as X,d as ee,T as se,e as re}from"./cardSkeleton-Dgv6s6GL.js";import{S as le}from"./searchBar-BtJCpjoL.js";const te=({data:s})=>{var i,d,m,h;const t=j(),r=E(),a=B("user"),c=(a==null?void 0:a._id)===((i=s==null?void 0:s.author)==null?void 0:i._id)||!1;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-black cursor-pointer rounded-full overflow-hidden",children:e.jsx("img",{src:((d=s==null?void 0:s.author)==null?void 0:d.avatar)||U,alt:"",className:"object-cover object-center  h-full"})}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx("h1",{className:"font-semibold cursor-pointer montserrat",children:(m=s==null?void 0:s.author)==null?void 0:m.fullName}),c&&e.jsxs("small",{onClick:()=>{t(P(s)),r(`/${p}/post`)},className:"hover:bg-gray-200/80 bg-gray-200/50  rounded-3xl px-3 py-1 transition-all duration-300 whitespace-nowrap flex items-center gap-x-1 font-medium cursor-pointer",children:[e.jsx(z,{className:"text-md"})," Update"]})]}),e.jsxs("small",{className:"font-medium cursor-pointer",children:["@",(h=s==null?void 0:s.author)==null?void 0:h.username]})]})]}),e.jsx("button",{className:"bg-black/90 hover:bg-black tracking-wider duration-300 transition-colors text-white px-5 py-1.5 rounded-3xl",children:"Follow"})]})})};var ae=["second","minute","hour","day","week","month","year"];function ne(s,t){if(t===0)return["just now","right now"];var r=ae[Math.floor(t/2)];return s>1&&(r+="s"),[s+" "+r+" ago","in "+s+" "+r]}var ce=["秒","分钟","小时","天","周","个月","年"];function ie(s,t){if(t===0)return["刚刚","片刻后"];var r=ce[~~(t/2)];return[s+" "+r+"前",s+" "+r+"后"]}var g={},A=function(s,t){g[s]=t},oe=function(s){return g[s]||g.en_US},f=[60,60,24,7,365/7/12,12];function $(s){return s instanceof Date?s:!isNaN(s)||/^\d+$/.test(s)?new Date(parseInt(s)):(s=(s||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(s))}function me(s,t){var r=s<0?1:0;s=Math.abs(s);for(var a=s,c=0;s>=f[c]&&c<f.length;c++)s/=f[c];return s=Math.floor(s),c*=2,s>(c===0?9:1)&&(c+=1),t(s,c,a)[r].replace("%s",s.toString())}function de(s,t){var r=t?$(t):new Date;return(+r-+$(s))/1e3}var xe=function(s,t,r){var a=de(s,r&&r.relativeDate);return me(a,oe(t))};A("en_US",ne);A("zh_CN",ie);const he=({blogId:s})=>{var w,y,b;const t=E(),r=j(),[a,c]=u.useState(!1),[i,d]=u.useState(""),[m,h]=u.useState(!0);u.useEffect(()=>{if(!s)return null;r(G(`/comments/${s}`))},[s]);const{data:x}=N(l=>l.comments);let n=B("user");const v=async()=>{if(!(n!=null&&n._id))return t(`/${p}/sign-in`),F.error("Please login or register.");if(i)if(a)r(k({id:a,title:i})),await D(a,i),d("");else if(n!=null&&n._id){const{result:l}=await H(s,i);l&&(r(I({id:l==null?void 0:l._id,title:i,author:{fullName:n==null?void 0:n.fullName,_id:n==null?void 0:n._id,avatar:n==null?void 0:n.avatar}})),d(""))}else return F.error("You have to login first!")};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between",children:((w=x==null?void 0:x.results)==null?void 0:w.length)<=0?e.jsx("h1",{className:"font-medium text-gray-500 my-3",children:"No comments here"}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"font-medium text-md mt-5 mb-3",children:["Comments (",((y=x==null?void 0:x.results)==null?void 0:y.length)||0,")"]}),e.jsx("span",{onClick:()=>{h(!m)},className:"flex items-center gap-1.5 cursor-pointer text-sm font-medium",children:m?e.jsxs(e.Fragment,{children:["Hide comments",e.jsx(O,{})]}):e.jsxs(e.Fragment,{children:["Show comments",e.jsx(J,{})]})})]})}),e.jsx("div",{className:`${m?"h-full":"h-0 overflow-hidden"}  duration-300 transition-[height]`,children:e.jsx("ul",{className:"flex flex-col gap-y-1 pl-3 pb-2 mb-4",children:(b=x==null?void 0:x.results)==null?void 0:b.map((l,T)=>{var C,_,S;return e.jsx("li",{className:"flex gap-x-2 pt-2 w-fit",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-8 h-8 shrink-0 bg-black rounded-full overflow-hidden cursor-pointer",children:e.jsx("img",{src:((C=l==null?void 0:l.author)==null?void 0:C.avatar)||U,alt:"avatar",className:"h-full"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"relative flex flex-col bg-gray-100 rounded-md w-auto px-3 py-1",children:[e.jsx("h1",{className:"font-semibold cursor-pointer montserrat text-sm",children:(_=l==null?void 0:l.author)==null?void 0:_.fullName}),e.jsx("span",{children:l==null?void 0:l.title}),((S=l==null?void 0:l.author)==null?void 0:S._id)===(n==null?void 0:n._id)&&e.jsxs("div",{className:"absolute top-1/2 -right-7 z-10 -translate-y-1/2 flex items-center flex-col gap-y-2",children:[e.jsx(L,{onClick:()=>{c(l==null?void 0:l._id),d(l==null?void 0:l.title)},className:"cursor-pointer text-gray-800 hover:text-black duration-300 transition-all"}),e.jsx(Q,{onClick:async()=>{r(M({id:l==null?void 0:l._id})),await R(l==null?void 0:l._id,s)},className:"cursor-pointer text-gray-800 hover:text-black duration-300 transition-all"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-between",children:[e.jsx("small",{className:"font-medium",children:xe(l==null?void 0:l.createdAt)}),e.jsxs("span",{className:"flex gap-x-3",children:[e.jsx("small",{className:"cursor-pointer font-medium",children:"Like"}),e.jsx("small",{className:"cursor-pointer font-medium",children:"Reply"})]})]})]})]})},T)})})}),e.jsxs("div",{className:"flex items-center gap-2 h-10 p-1 rounded-3xl bg-gray-100 ",children:[e.jsx("input",{type:"text",value:i,onKeyDown:async l=>{l.key==="Enter"&&(a?(r(k({id:a,title:i})),await D(a,i),d("")):v())},onChange:l=>d(l.target.value),placeholder:"Type your comment here",className:"w-full h-full pl-5 bg-transparent"}),e.jsx("div",{onClick:v,className:"pr-5 capitalize pl-3 border-l border-black/40 hover:text-slate-700 font-medium duration-300 transition-all  flex items-center justify-center cursor-pointer",children:"send"})]})]})},ue=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"max-[500px]:h-[300px] md:h-[500px] h-[400px]",children:e.jsx(o,{className:"h-full"})}),e.jsx(o,{height:13,width:120,className:"mt-4"}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex gap-2 my-2",children:[e.jsx(o,{height:35,width:35,circle:!0}),e.jsxs("div",{className:"",children:[e.jsx(o,{width:90}),e.jsx(o,{width:50,height:10})]})]}),e.jsx(o,{width:100,height:28})]}),e.jsx("div",{className:"flex items-center gap-3 mb-3",children:[...Array(8)].map((s,t)=>e.jsx(o,{width:70,height:23},t))}),e.jsx(o,{height:25,count:1.8}),e.jsx("div",{className:"mb-5"}),e.jsx(o,{count:7.7}),e.jsx("div",{className:"mt-5"}),e.jsx(o,{count:5.3}),e.jsx("div",{className:"mt-5"}),e.jsx(o,{count:3.8}),e.jsxs("div",{className:"border-t border-b border-gray-900 pb-2 pt-1 flex items-center justify-between mt-5",children:[e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(o,{width:25,height:25,circle:!0}),e.jsx(o,{width:25,height:25,circle:!0}),e.jsx(o,{width:25,height:25,circle:!0})]}),e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(o,{width:25,height:25,circle:!0}),e.jsx(o,{width:25,height:25,circle:!0})]})]})]})}),je=({tagName:s,currentBlog:t})=>{var i,d;const r=j();u.useEffect(()=>{r(q(`/search?query=${s}&limit=6&${K}`))},[s]);const{data:a,loading:c}=N(m=>m.filterBlogs);return((i=a==null?void 0:a.results)==null?void 0:i.length)<=1?null:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"py-5 w-full",children:[e.jsx("h1",{className:"font-medium text-lg mb-5",children:"Similar titles"}),c?e.jsx("div",{className:"flex flex-col gap-y-4",children:[...Array(5)].map((m,h)=>e.jsx(V,{reverse:!0},h))}):e.jsx("ul",{className:"flex flex-col gap-y-5 w-full",children:(d=a==null?void 0:a.results)==null?void 0:d.map((m,h)=>(m==null?void 0:m._id)===t?null:e.jsx(X,{item:m},h))})]})})},Ne=()=>{const{id:s}=Y(),t=j();u.useEffect(()=>{if(!s)return null;t(Z(`/blogs/${s}`))},[s]);const{data:r,loading:a,error:c}=N(i=>i.singleBlog);return c?e.jsx(W,{to:`/${p}/error`}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden w-4/5 mx-auto mt-5",children:e.jsx(le,{})}),e.jsxs("div",{className:"w-screen md:px-[15%] px-[5%] mt-5 pb-5",children:[a?e.jsx(ue,{}):e.jsxs("div",{className:"flex flex-col",children:[e.jsx("img",{src:r==null?void 0:r.thumbnail,alt:""}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[e.jsx("span",{className:"font-medium text-sm",children:"Author"}),e.jsxs("span",{className:"flex items-center gap-1 font-medium text-sm text-gray-800",children:["Published on ",ee(r==null?void 0:r.createdAt,"mmm d, yyyy")]})]}),e.jsx(te,{data:r}),e.jsx(se,{data:r}),e.jsx("h1",{className:"font-medium text-3xl my-3",children:r==null?void 0:r.heading}),e.jsx("div",{className:"description mb-5 text-md font-medium",dangerouslySetInnerHTML:{__html:r==null?void 0:r.description}}),e.jsx(re,{item:r,singleBlog:!0}),e.jsx(he,{blogId:s})]})]}),e.jsxs("div",{className:"flex gap-5 md:flex-nowrap flex-wrap gap-y-6 mt-5",children:[e.jsx("div",{className:"md:w-2/3 w-full shrink-0 md:border-r md:pr-4",children:e.jsx(je,{tagName:r==null?void 0:r.tags[0],currentBlog:s})}),e.jsx("div",{className:"mt-5 pt-10 gap-2 flex flex-wrap"})]})]})]})};export{Ne as default};
