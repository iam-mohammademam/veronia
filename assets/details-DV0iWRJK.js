import{j as e,n as $,a as T,u as g,r as x,p as U,b as p,c as P,F as z,q as G,t as L,v as S,w as k,i as E,_ as D,x as M,y as R,z as c,B as H,s as I,C as q,D as K,N as Y}from"./index-CF2cXKIB.js";import{G as Z,b as W,c as J,C as O,a as Q,d as V,T as X,e as ee}from"./cardSkeleton-SrBsDzo5.js";import{S as se}from"./searchBar-BYx9xTdk.js";const re=({data:s})=>{var t,r,a;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-black cursor-pointer rounded-full overflow-hidden",children:e.jsx("img",{src:((t=s==null?void 0:s.author)==null?void 0:t.avatar)||$,alt:"",className:"object-cover object-center  h-full"})}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"font-semibold cursor-pointer montserrat",children:(r=s==null?void 0:s.author)==null?void 0:r.fullName}),e.jsxs("small",{className:"font-medium cursor-pointer",children:["@",(a=s==null?void 0:s.author)==null?void 0:a.username]})]})]}),e.jsx("button",{className:"bg-black/90 hover:bg-black tracking-wider duration-300 transition-colors text-white px-5 py-1.5 rounded-3xl",children:"Follow"})]})})};var le=["second","minute","hour","day","week","month","year"];function te(s,t){if(t===0)return["just now","right now"];var r=le[Math.floor(t/2)];return s>1&&(r+="s"),[s+" "+r+" ago","in "+s+" "+r]}var ae=["秒","分钟","小时","天","周","个月","年"];function ne(s,t){if(t===0)return["刚刚","片刻后"];var r=ae[~~(t/2)];return[s+" "+r+"前",s+" "+r+"后"]}var f={},A=function(s,t){f[s]=t},ce=function(s){return f[s]||f.en_US},j=[60,60,24,7,365/7/12,12];function F(s){return s instanceof Date?s:!isNaN(s)||/^\d+$/.test(s)?new Date(parseInt(s)):(s=(s||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(s))}function ie(s,t){var r=s<0?1:0;s=Math.abs(s);for(var a=s,i=0;s>=j[i]&&i<j.length;i++)s/=j[i];return s=Math.floor(s),i*=2,s>(i===0?9:1)&&(i+=1),t(s,i,a)[r].replace("%s",s.toString())}function oe(s,t){var r=t?F(t):new Date;return(+r-+F(s))/1e3}var me=function(s,t,r){var a=oe(s,r&&r.relativeDate);return ie(a,ce(t))};A("en_US",te);A("zh_CN",ne);const de=({blogId:s})=>{var v,w,y;const t=T(),r=g(),[a,i]=x.useState(!1),[o,h]=x.useState(""),[m,u]=x.useState(!0);x.useEffect(()=>{if(!s)return null;r(U(`/comments/${s}`))},[s]);const{data:d}=p(l=>l.comments);let n=P("user");const N=async()=>{if(!(n!=null&&n._id))return t(`/${E}/sign-in`),D.error("Please login or register.");if(o)if(a)r(S({id:a,title:o})),await k(a,o),h("");else if(n!=null&&n._id){const{result:l}=await M(s,o);l&&(r(R({id:l==null?void 0:l._id,title:o,author:{fullName:n==null?void 0:n.fullName,_id:n==null?void 0:n._id,avatar:n==null?void 0:n.avatar}})),h(""))}else return D.error("You have to login first!")};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between",children:((v=d==null?void 0:d.results)==null?void 0:v.length)<=0?e.jsx("h1",{className:"font-medium text-gray-500 my-3",children:"No comments here"}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"font-medium text-md mt-5 mb-3",children:["Comments (",((w=d==null?void 0:d.results)==null?void 0:w.length)||0,")"]}),e.jsx("span",{onClick:()=>{u(!m)},className:"flex items-center gap-1.5 cursor-pointer text-sm font-medium",children:m?e.jsxs(e.Fragment,{children:["Hide comments",e.jsx(W,{})]}):e.jsxs(e.Fragment,{children:["Show comments",e.jsx(Z,{})]})})]})}),e.jsx("div",{className:`${m?"h-full":"h-0 overflow-hidden"}  duration-300 transition-[height]`,children:e.jsx("ul",{className:"flex flex-col gap-y-1 pl-3 pb-2 mb-4",children:(y=d==null?void 0:d.results)==null?void 0:y.map((l,B)=>{var b,C,_;return e.jsx("li",{className:"flex gap-x-2 pt-2 w-fit",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-8 h-8 shrink-0 bg-black rounded-full overflow-hidden cursor-pointer",children:e.jsx("img",{src:((b=l==null?void 0:l.author)==null?void 0:b.avatar)||$,alt:"avatar",className:"h-full"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"relative flex flex-col bg-gray-100 rounded-md w-auto px-3 py-1",children:[e.jsx("h1",{className:"font-semibold cursor-pointer montserrat text-sm",children:(C=l==null?void 0:l.author)==null?void 0:C.fullName}),e.jsx("span",{children:l==null?void 0:l.title}),((_=l==null?void 0:l.author)==null?void 0:_._id)===(n==null?void 0:n._id)&&e.jsxs("div",{className:"absolute top-1/2 -right-7 z-10 -translate-y-1/2 flex items-center flex-col gap-y-2",children:[e.jsx(z,{onClick:()=>{i(l==null?void 0:l._id),h(l==null?void 0:l.title)},className:"cursor-pointer text-gray-800 hover:text-black duration-300 transition-all"}),e.jsx(J,{onClick:async()=>{r(G({id:l==null?void 0:l._id})),await L(l==null?void 0:l._id,s)},className:"cursor-pointer text-gray-800 hover:text-black duration-300 transition-all"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 justify-between",children:[e.jsx("small",{className:"font-medium",children:me(l==null?void 0:l.createdAt)}),e.jsxs("span",{className:"flex gap-x-3",children:[e.jsx("small",{className:"cursor-pointer font-medium",children:"Like"}),e.jsx("small",{className:"cursor-pointer font-medium",children:"Reply"})]})]})]})]})},B)})})}),e.jsxs("div",{className:"flex items-center gap-2 h-10 p-1 rounded-3xl bg-gray-100 ",children:[e.jsx("input",{type:"text",value:o,onKeyDown:async l=>{l.key==="Enter"&&(a?(r(S({id:a,title:o})),await k(a,o),h("")):N())},onChange:l=>h(l.target.value),placeholder:"Type your comment here",className:"w-full h-full pl-5 bg-transparent"}),e.jsx("div",{onClick:N,className:"pr-5 capitalize pl-3 border-l border-black/40 hover:text-slate-700 font-medium duration-300 transition-all  flex items-center justify-center cursor-pointer",children:"send"})]})]})},he=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"max-[500px]:h-[300px] md:h-[500px] h-[400px]",children:e.jsx(c,{className:"h-full"})}),e.jsx(c,{height:13,width:120,className:"mt-4"}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex gap-2 my-2",children:[e.jsx(c,{height:35,width:35,circle:!0}),e.jsxs("div",{className:"",children:[e.jsx(c,{width:90}),e.jsx(c,{width:50,height:10})]})]}),e.jsx(c,{width:100,height:28})]}),e.jsx("div",{className:"flex items-center gap-3 mb-3",children:[...Array(8)].map((s,t)=>e.jsx(c,{width:70,height:23},t))}),e.jsx(c,{height:25,count:1.8}),e.jsx("div",{className:"mb-5"}),e.jsx(c,{count:7.7}),e.jsx("div",{className:"mt-5"}),e.jsx(c,{count:5.3}),e.jsx("div",{className:"mt-5"}),e.jsx(c,{count:3.8}),e.jsxs("div",{className:"border-t border-b border-gray-900 pb-2 pt-1 flex items-center justify-between mt-5",children:[e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(c,{width:25,height:25,circle:!0}),e.jsx(c,{width:25,height:25,circle:!0}),e.jsx(c,{width:25,height:25,circle:!0})]}),e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(c,{width:25,height:25,circle:!0}),e.jsx(c,{width:25,height:25,circle:!0})]})]})]})}),xe=({tagName:s,currentBlog:t})=>{var o,h;const r=g();x.useEffect(()=>{r(H(`/search?query=${s}&limit=6&${I}`))},[s]);const{data:a,loading:i}=p(m=>m.filterBlogs);return((o=a==null?void 0:a.results)==null?void 0:o.length)<=1?null:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"py-5 w-full",children:[e.jsx("h1",{className:"font-medium text-lg mb-5",children:"Similar titles"}),i?e.jsx("div",{className:"flex flex-col gap-y-4",children:[...Array(5)].map((m,u)=>e.jsx(O,{reverse:!0},u))}):e.jsx("ul",{className:"flex flex-col gap-y-5 w-full",children:(h=a==null?void 0:a.results)==null?void 0:h.map((m,u)=>(m==null?void 0:m._id)===t?null:e.jsx(Q,{item:m},u))})]})})},ge=()=>{const{id:s}=q(),t=g();x.useEffect(()=>{if(!s)return null;t(K(`/blogs/${s}`))},[s]);const{data:r,loading:a,error:i}=p(o=>o.singleBlog);return i?e.jsx(Y,{to:`/${E}/error`}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden w-4/5 mx-auto mt-5",children:e.jsx(se,{})}),e.jsxs("div",{className:"w-screen md:px-[15%] px-[5%] mt-5 pb-5",children:[a?e.jsx(he,{}):e.jsxs("div",{className:"flex flex-col",children:[e.jsx("img",{src:r==null?void 0:r.thumbnail,alt:""}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[e.jsx("span",{className:"font-medium text-sm",children:"Author"}),e.jsxs("span",{className:"flex items-center gap-1 font-medium text-sm text-gray-800",children:["Published on ",V(r==null?void 0:r.createdAt,"mmm d, yyyy")]})]}),e.jsx(re,{data:r}),e.jsx(X,{data:r}),e.jsx("h1",{className:"font-medium text-2xl my-3",children:r==null?void 0:r.heading}),e.jsx("div",{className:"description mb-5",dangerouslySetInnerHTML:{__html:r==null?void 0:r.description}}),e.jsx(ee,{item:r,singleBlog:!0}),e.jsx(de,{blogId:s})]})]}),e.jsxs("div",{className:"flex gap-5 md:flex-nowrap flex-wrap gap-y-6 mt-5",children:[e.jsx("div",{className:"md:w-2/3 w-full shrink-0 md:border-r md:pr-4",children:e.jsx(xe,{tagName:r==null?void 0:r.tags[0],currentBlog:s})}),e.jsx("div",{className:"mt-5 pt-10 gap-2 flex flex-wrap"})]})]})]})};export{ge as default};
